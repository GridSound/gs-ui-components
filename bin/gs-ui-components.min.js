"use strict";function gsuiOscilloscope(t){this.canvas=t,this.ctx=t.getContext("2d"),this.maxValue=0,this.setPinch(0),this.drawBegin(function(t,i,s,e){t.fillRect(0,0,s,e),t.lineWidth=2,t.strokeStyle="rgb(255,255,255)"}),this.drawEnd()}function gsuiPopup(t){this.elRoot=t,this.elWindow=t.querySelector(".gsuiPopup-window"),this.elHeader=t.querySelector(".gsuiPopup-window header"),this.elMsg=t.querySelector(".gsui-msg"),this.elText=t.querySelector(".gsui-text"),this.elCancel=t.querySelector(".gsui-cancel"),this.elOk=t.querySelector(".gsui-ok"),this.elForm=t.querySelector("form");var i=this;t.onclick=this.elCancel.onclick=function(){i.resolve("confirm"!==i.type&&("prompt"===i.type?null:void 0))},this.elWindow.onclick=function(t){t.stopPropagation()},this.elForm.onsubmit=function(){return i.resolve("confirm"===i.type||("prompt"===i.type?i.elText.value:void 0)),!1},this.elText.onkeypress=this.elText.onkeydown=this.elText.onkeyup=function(t){t.stopPropagation()}}function gsuiSlider(t){var i=t.querySelector("input");this.elRoot=t,this.elThumb=t.querySelector(".gsui-thumb"),this.elLine=t.querySelector(".gsui-line"),this.elLineColor=t.querySelector(".gsui-lineColor"),this.input=i,this.elRoot.onwheel=this._wheel.bind(this),this.elRoot.onmousedown=this._mousedown.bind(this),this.options({min:i.min||0,max:i.max||100,step:i.step||1,value:i.value||0,startFrom:0})}function gsuiSpanEditable(t,i){this.element=t,this.data=i,this.placeholder="",this.span=t.querySelector("span"),this.input=t.querySelector("input"),t.ondblclick=this.__elementDblclick.bind(this),this.input.onblur=this.__inputBlur.bind(this),this.input.onkeydown=this.__inputKeydown.bind(this)}function gsuiSpectrum(t){this.canvas=t,this.canvas.height=1,this.ctx=t.getContext("2d"),this.colors=[[5,2,20],[8,5,30],[15,7,50],[75,7,35],[80,0,0],[180,0,0],[200,25,10],[200,128,10],[200,200,20]]}function gsuiToggle(t,i){this.element=t,this.data=i,this.isOn=!1,this._circleClass=t.querySelector(".gsui-circle").classList,t.oncontextmenu=function(){return!1},t.onmousedown=this.__elementMousedown.bind(this)}function gsuiWaveform(t){this.svg=t,this.polygon=t.querySelector("polygon")}!function(){var t=Handlebars.template,i=Handlebars.templates=Handlebars.templates||{};i.gsuiEQ=t({compiler:[7,">= 4.0.0"],main:function(t,i,s,e,n){return'<div class="gsuiEQ">\n\t<div class="gsui-left">\n\t\t<div class="gsui-graph">\n\t\t\t<canvas class="gsui-spectrum"></canvas>\n\t\t\t<div class="gsui-dots"></div>\n\t\t\t<div class="gsui-dBs">\n\t\t\t\t<div class="gsui-dB" title="+18 dB">+18</div>\n\t\t\t\t<div class="gsui-dB" title="+6 dB">+6</div>\n\t\t\t\t<div class="gsui-dB" title="0 dB">0</div>\n\t\t\t\t<div class="gsui-dB" title="-6 dB">-6</div>\n\t\t\t\t<div class="gsui-dB" title="-18 dB">-18</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="gsui-Hzs">\n\t\t\t<div class="gsui-Hz" style="width:  5.5%"></div>\n\t\t\t<div class="gsui-Hz" style="width:  5.0%" title="200 Hz">.2</div>\n\t\t\t<div class="gsui-Hz" style="width:  7.5%" title="500 Hz">.5</div>\n\t\t\t<div class="gsui-Hz" style="width: 12.1%" title="1 kHz">1</div>\n\t\t\t<div class="gsui-Hz" style="width: 25.0%" title="2 kHz">2</div>\n\t\t\t<div class="gsui-Hz" style="width: 24.5%" title="5 kHz">5</div>\n\t\t\t<div class="gsui-Hz" style="flex: 1" title="10 kHz">10</div>\n\t\t</div>\n\t\t<div class="gsui-settings">\n\t\t\t<span class="gsui-title">EQ</span>\n\t\t\t<label>\n\t\t\t\t<span class="gsui-bands">bands&nbsp;:</span>\n\t\t\t\t<input class="gsui-nbBands" type="number" value="7" min="1" max="7"/>\n\t\t\t</label>\n\t\t</div>\n\t</div>\n\t<div class="gsui-filters"></div>\n</div>\n'},useData:!0}),i.gsuiOscilloscope=t({compiler:[7,">= 4.0.0"],main:function(t,i,s,e,n){return'<canvas class="gsuiOscilloscope"></canvas>\r\n'},useData:!0}),i.gsuiPopup=t({compiler:[7,">= 4.0.0"],main:function(t,i,s,e,n){return'<div class="gsuiPopup">\r\n\t<div class="gsuiPopup-window">\r\n\t\t<header></header>\r\n\t\t<div class="gsui-msg"></div>\r\n\t\t<form>\r\n\t\t\t<input type="text" class="gsui-text"\r\n\t\t\t/><input type="button" class="gsui-btn gsui-cancel" value="Cancel"\r\n\t\t\t/><input type="submit" class="gsui-btn gsui-ok" value="Ok"/>\r\n\t\t</form>\r\n\t</div>\r\n</div>\r\n'},useData:!0}),i.gsuiSlider=t({compiler:[7,">= 4.0.0"],main:function(t,i,s,e,n){return'<div class="gsuiSlider">\n\t<input type="range"/>\n\t<div class="gsui-track"></div>\n\t<div class="gsui-line">\n\t\t<div class="gsui-lineColor"></div>\n\t\t<div class="gsui-thumb"></div>\n\t</div>\n</div>\n'},useData:!0}),i.gsuiSpanEditable=t({compiler:[7,">= 4.0.0"],main:function(t,i,s,e,n){return'<div class="gsuiSpanEditable">\r\n\t<span class="gsui-textOverflow"></span>\r\n\t<input type="text"/>\r\n</div>\r\n'},useData:!0}),i.gsuiSpectrum=t({compiler:[7,">= 4.0.0"],main:function(t,i,s,e,n){return'<canvas class="gsuiSpectrum"></canvas>\r\n'},useData:!0}),i.gsuiToggle=t({compiler:[7,">= 4.0.0"],main:function(t,i,s,e,n){return'<div class="gsuiToggle">\r\n\t<div class="gsui-circle"></div>\r\n</div>'},useData:!0}),i.gsuiWaveform=t({compiler:[7,">= 4.0.0"],main:function(t,i,s,e,n){return'<svg class="gsuiWaveform" preserveAspectRatio="none">\r\n\t<polygon/>\r\n</svg>\r\n'},useData:!0})}(),gsuiOscilloscope.prototype={setResolution:function(t,i){this.canvas.width=t,this.canvas.height=i},clear:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},setPinch:function(t){this.pinch=Math.max(0,Math.min(t,1))},drawBegin:function(t){this.fnBegin=t||function(){}},drawEnd:function(t){this.fnEnd=t||function(){}},draw:function(t){var i,s,e=this.maxValue,n=this.canvas,l=this.ctx,o=n.width,u=n.height,a=u/2,h=t.length,c=Math.ceil(this.pinch/2*h),r=o/(h-1);if(this.fnBegin(l,e,o,u)!==!1){for(l.beginPath(),e=0,i=0;i<h;++i)s=t[i]/128-1,e=Math.max(e,Math.abs(s)),(i<c||h-c<=i)&&(s*=.5-Math.cos(Math.PI*(i<c?i:h-1-i)/c)/2),0===i?l.moveTo(0,a+s*a):l.lineTo(i*r,a+s*a);this.fnEnd(l,e,o,u),l.stroke(),this.maxValue=e}}},gsuiPopup.prototype={close:function(){this.isOpen&&this.elCancel.click()},open:function(t,i,s,e){this.isOpen=!0,this.elHeader.textContent=i,this.elMsg.innerHTML=s,this.elText.value=arguments.length>3?e:"",this.elWindow.dataset.gsuiType=this.type=t,this.elWindow.classList.toggle("gsui-nocancel","prompt"!==t&&"confirm"!==t),this.elWindow.classList.toggle("gsui-notext","prompt"!==t),this.elRoot.classList.add("gsui-show");var n=this;return setTimeout(function(){"prompt"===t?n.elText.select():n.elOk.focus()},250),new Promise(function(t){n.resolve=t}).then(function(t){return n.isOpen=!1,n.elRoot.classList.remove("gsui-show"),t})}},document.body.addEventListener("mousemove",function(t){gsuiSlider._sliderClicked&&gsuiSlider._sliderClicked._mousemove(t)}),document.body.addEventListener("mouseup",function(t){gsuiSlider._sliderClicked&&gsuiSlider._sliderClicked._mouseup(t)}),gsuiSlider.prototype={setValue:function(t){var i=this.input.value;this.input.value=t,this.input.value!==i&&this._updateVal()},options:function(t){var i,s,e=this.input;for(i in t)s=this[i]=t[i],"startFrom"===i?this.startFrom=s:e[i]=s;this.startFrom=Math.max(e.min,Math.min(this.startFrom,e.max)),this._updateVal()},resize:function(t,i){this.elRoot.style.width=t+"px",this.elRoot.style.height=i+"px",this._updateSize(t,i)},resized:function(){var t=this.elRoot.getBoundingClientRect();this._updateSize(t.width,t.height)},_updateVal:function(){var t=this.input,i=t.value,s=this.startFrom,e=(i-t.min)/(t.max-t.min)*100,n=(s-t.min)/(t.max-t.min)*100;this._value=i,this.elThumb.style.top=100-e+"%",this.elLineColor.style.top=(s<i?100-e:100-n)+"%",this.elLineColor.style.bottom=(s<i?n:e)+"%"},_updateSize:function(t,i){if(t!==this.width||i!==this.height){var s=Math.floor(t/2),e=Math.ceil(t/10);e%2!==t%2&&++e,s%2&&++s,this.width=t,this.height=i,this.elThumb.style.width=this.elThumb.style.height=t-s+"px",this.elThumb.style.marginLeft=this.elThumb.style.marginTop=(t-s)/-2+"px",this.elLine.style.width=e+"px",this.elLine.style.marginLeft=e/-2+"px",this.elLine.style.top=this.elLine.style.bottom=t/2+"px"}},_wheel:function(t){var i=this.input,s=t.deltaY>0?-1:1;i.value=+i.value+i.step*s,this._updateVal()},_mousedown:function(t){gsuiSlider._sliderClicked=this,this._rcLine=this.elLine.getBoundingClientRect(),this.elThumb.classList.add("gsui-big"),this._mousemove(t)},_mouseup:function(t){delete gsuiSlider._sliderClicked,this.elThumb.classList.remove("gsui-big")},_mousemove:function(t){var i=1-(t.pageY-this._rcLine.top)/(this._rcLine.height-1),s=+this.input.min,e=+this.input.max;this.setValue(s+i*(e-s))}},gsuiSpanEditable.prototype={getValue:function(){return this.value},setValue:function(t){t=t.trim(),t===this.placeholder&&(t=""),this.element.classList.toggle("gsui-empty",!t),this.span.textContent=t||this.placeholder,t!==this.value&&(this.value=t,this.data.onchange&&this.data.onchange(this.value))},setPlaceholder:function(t){this.placeholder=t.trim(),this.value||this.setValue(t)},__elementDblclick:function(t){this.input.value=this.value,this.element.classList.add("gsui-editing"),this.input.focus(),this.input.select()},__inputBlur:function(t){this.__esc||(this.setValue(t.target.value),this.element.classList.remove("gsui-editing")),this.__esc=!1},__inputKeydown:function(t){t.stopPropagation(),13!==t.keyCode&&27!==t.keyCode||(this.__esc=27===t.keyCode,this.__esc||this.setValue(t.target.value),this.element.classList.remove("gsui-editing"))}},gsuiSpectrum.prototype={setResolution:function(t){this.canvas.width=t},clear:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},draw:function(t){var i,s,e,n,l,o,u,a=0,h=0,c=this.canvas,r=this.ctx,d=c.width,g=c.height,p=t.length;for(p!==this.datalen&&(this._calcWidths(t,p,d),this.datalen=p),u=this._widths;h<p;++h)i=1-Math.cos(t[h]/255*Math.PI/2),i<.05?(n=4+10*i,l=4+10*i,o=5+20*i):(i<.08?(e=0,i/=.08):i<.15?(e=1,i/=.15):i<.17?(e=2,i/=.17):i<.25?(e=3,i/=.25):i<.3?(e=4,i/=.3):i<.4?(e=5,i/=.4):i<.6?(e=6,i/=.6):i<.8?(e=7,i/=.8):e=8,s=this.colors[e],n=s[0]*i,l=s[1]*i,o=s[2]*i),r.fillStyle="rgb("+~~n+","+~~l+","+~~o+")",r.fillRect(a,0,u[h],g),a+=u[h]},_calcWidths:function(t,i,s){var e,n=0,l=new Array(i);for(e=0;e<i;++e)n+=l[e]=Math.log(i/(e+1));for(e=0;e<i;++e)l[e]=l[e]/n*s;this._widths=l}},gsuiToggle.prototype={toggle:function(t){t!==this.isOn&&(this.isOn=t,this._circleClass.toggle("gsui-on",t),this.data.onchange&&this.data.onchange(t))},groupWith:function(t){var i=this.group;t.group=t.group||[t],t!==this&&i!==t.group&&(i&&i.splice(i.indexOf(this),1),this.group=t.group,t.group.push(this))},__elementMousedown:function(t){if(0===t.button)this.toggle(!this.isOn);else if(2===t.button){if(this.group){var i=this.group.every(function(t){return t===this||!t.isOn},this);this.group.forEach(function(t){t!==this&&t.toggle(i)},this)}this.toggle(!0)}}},gsuiWaveform.prototype={setResolution:function(t,i){this.width=t,this.height=i,this.svg.setAttribute("viewBox","0 0 "+t+" "+i)},clear:function(){this.polygon.removeAttribute("points")},draw:function(t,i,s,e,n){var l,o=this.width,u=this.height,a=u/2,h=t.length,c=~~(e/s*h),r=n/s*h/o,d="0,"+(a+t[c]*a),g="0,"+(a+i[c]*a),p=~~Math.max(1,r/100);for(l=1;l<o;++l){for(var v=1/0,m=-(1/0),f=~~(c+(l-1)*r),y=f+r;f<y;f+=p)v=Math.min(v,t[f],i[f]),m=Math.max(m,i[f],t[f]);Math.abs(m-v)*a<1&&(m+=1/u,v-=1/u),d+=" "+l+","+(a+v*a),g=l+","+(a+m*a)+" "+g}this.polygon.setAttribute("points",d+" "+g)}};