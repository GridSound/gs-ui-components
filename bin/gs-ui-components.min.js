"use strict";var _Mathsin=Math.sin,_Mathcos=Math.cos,_MathPI=Math.PI,_Mathabs=Math.abs,_Mathceil=Math.ceil,_Mathmin=Math.min,_Mathmax=Math.max;function gsuiBeatLines(c){this.rootElement=c=c||document.createElementNS("http://www.w3.org/2000/svg","svg"),c.setAttribute("preserveAspectRatio","none"),c.classList.add("gsuiBeatLines"),this.elTime=this._newRect(),this.elHLstart=this._newRect(),this.elHLend=this._newRect(),this.elTime.setAttribute("class","gsui-currentTime"),this.elHLstart.setAttribute("class","gsui-hlStart"),this.elHLend.setAttribute("class","gsui-hlEnd"),this.elHLstart.setAttribute("x",0),this.elHLend.setAttribute("width","10000%"),this._zoom=1 .toFixed(6),this._offset=0,this._beatsPerMeasure=this._stepsPerBeat=4,this.steps=[],this.currentTime(0),this.setResolution(256),this.highlight(!1)}gsuiBeatLines.prototype={setResolution:function(c){this.width=c,this.rootElement.setAttribute("viewBox","0 0 "+c+" 1")},currentTime:function(c){this._currentTime=c,this._timeUpdate()},zoom:function(c,f){if(c=_Mathmax(.01,c).toFixed(6),c!==this._zoom){var j=getComputedStyle(this.rootElement).fontSize,m=this.width/parseFloat(j),o=(m-m/(c/this._zoom))*f;this._zoom=c,this.rootElement.style.fontSize=c+"em",this.offset(this._offset+o)}},offset:function(c){this._offset=_Mathmax(0,+c||0),this._render()},beatsPerMeasure:function(c){this._beatsPerMeasure=_Mathmax(1,~~c),this._render()},stepsPerBeat:function(c){this._stepsPerBeat=_Mathmin(_Mathmax(1,~~c),16),this._render()},highlight:function(c){this._hl=!!c,this.elHLstart.style.display=this.elHLend.style.display=c?"block":"none",this._hl&&(this._hlStart(),this._hlEnd())},highlightStart:function(c){this._hlA=+c,this._hl&&this._hlStart()},highlightEnd:function(c){this._hlB=+c,this._hl&&this._hlEnd()},render:function(){this._render()},_render:function(){for(var c,f,j=this.steps,m=getComputedStyle(this.rootElement),o=parseFloat(m.fontSize),q=this._stepsPerBeat,t=q*this._beatsPerMeasure,u=_Mathceil(this.width/o*q),v=this._offset*q,z=1/q,A=0,B=~~v+1,C=-(v%1)/q+z;j.length<u;)j.push(this._newRect());for(;A<u;++A)c="gsui-"+(B%t?B%q?"step":"beat":"measure"),f=j[A],f.style.display="block",f.setAttribute("x",C+"em"),f.setAttribute("class",c),f.setAttribute("width","gsui-measure"===c?"2px":"1px"),++B,C+=z;for(;A<j.length;++A)j[A].style.display="none";this._timeUpdate(),this._hl&&(this._hlStart(),this._hlEnd())},_newRect:function(){var c=document.createElementNS("http://www.w3.org/2000/svg","rect");return c.setAttribute("y",0),c.setAttribute("height","1px"),c.setAttribute("width","1px"),this.rootElement.prepend(c),c},_timeUpdate:function(){var c=this._currentTime-this._offset;this.elTime.style.display=0<c?"block":"none",this.elTime.setAttribute("x",c+"em")},_hlStart:function(){var c=_Mathmax(0,this._hlA-this._offset);this.elHLstart.setAttribute("width",c+"em")},_hlEnd:function(){this.elHLend.setAttribute("x",this._hlB-this._offset+"em")}};function gsuiEQ(){var c=this._clone(),f=c.querySelector("canvas");this.rootElement=c,this.uiSpectrum=new gsuiSpectrum(f),this.uiSpectrum.setResolution(256)}gsuiEQ.prototype={drawSpectrum:function(c){this.uiSpectrum.draw(c)},_clone:function(){var c=document.createElement("div");return gsuiEQ.template=gsuiEQ.template||this._init(),c.appendChild(document.importNode(gsuiEQ.template.content,!0)),c.removeChild(c.querySelector("*"))},_init:function(){return document.getElementById("gsuiEQ")}};function gsuiOscilloscope(c){this.rootElement=c||document.createElement("canvas"),this.rootElement.classList.add("gsuiOscilloscope"),this.ctx=this.rootElement.getContext("2d"),this.maxValue=0,this.setPinch(0),this.drawBegin(function(f,j,m,o){f.clearRect(0,0,m,o),f.lineWidth=2,f.strokeStyle="#fff"}),this.drawEnd()}gsuiOscilloscope.prototype={setResolution:function(c,f){this.rootElement.width=c,this.rootElement.height=f},clear:function(){this.ctx.clearRect(0,0,this.rootElement.width,this.rootElement.height)},setPinch:function(c){this.pinch=_Mathmax(0,_Mathmin(c,1))},drawBegin:function(c){this.fnBegin=c||function(){}},drawEnd:function(c){this.fnEnd=c||function(){}},draw:function(c){var f,j,m=this.maxValue,o=this.rootElement,q=this.ctx,t=o.width,u=o.height,v=u/2,z=c.length,A=_Mathceil(this.pinch/2*z);if(!1!==this.fnBegin(q,m,t,u)){for(q.beginPath(),m=0,f=0;f<z;++f)j=c[f]/128-1,m=_Mathmax(m,_Mathabs(j)),(f<A||z-A<=f)&&(j*=.5-_Mathcos(_MathPI*(f<A?f:z-1-f)/A)/2),0===f?q.moveTo(0,v+j*v):q.lineTo(f*(t/(z-1)),v+j*v);this.fnEnd(q,m,t,u),q.stroke(),this.maxValue=m}}},window.gsuiPopup={alert:function(c,f){return gsuiPopup._open("alert",c,f)},confirm:function(c,f){return gsuiPopup._open("confirm",c,f)},prompt:function(c,f,j){return gsuiPopup._open("prompt",c,f,j)},close:function(){gsuiPopup.isOpen&&gsuiPopup.elCancel.click()},_init:function(){var c=gsuiPopup,f=document.getElementById("gsuiPopup");c.elRoot=f,c.elWindow=f.querySelector("#gsuiPopup-window"),c.elHeader=f.querySelector("#gsuiPopup-window header"),c.elMsg=f.querySelector(".gsui-msg"),c.elText=f.querySelector(".gsui-text"),c.elCancel=f.querySelector(".gsui-cancel"),c.elOk=f.querySelector(".gsui-ok"),c.elForm=f.querySelector("form"),f.onclick=c.elCancel.onclick=c._cancelClick,c.elForm.onsubmit=c._submit,c.elText.onkeypress=c.elText.onkeydown=c.elText.onkeyup=c.elWindow.onclick=function(j){j.stopPropagation()},c._ready=!0},_open:function(c,f,j,m){var o=gsuiPopup;return o._ready||o._init(),o.isOpen=!0,o.elHeader.textContent=f,o.elMsg.innerHTML=j,o.elText.value=3<arguments.length?m:"",o.elWindow.dataset.gsuiType=o.type=c,o.elWindow.classList.toggle("gsui-nocancel","prompt"!==c&&"confirm"!==c),o.elWindow.classList.toggle("gsui-notext","prompt"!==c),o.elRoot.classList.add("gsui-show"),setTimeout(function(){"prompt"===c?o.elText.select():o.elOk.focus()},250),new Promise(function(q){o.resolve=q}).then(function(q){return o.isOpen=!1,o.elRoot.classList.remove("gsui-show"),q})},_cancelClick:function(){gsuiPopup.resolve("confirm"!==gsuiPopup.type&&("prompt"===gsuiPopup.type?null:void 0))},_submit:function(){return gsuiPopup.resolve("confirm"===gsuiPopup.type||("prompt"===gsuiPopup.type?gsuiPopup.elText.value:void 0)),!1}};function gsuiSlider(){var c=this._clone(),f=c.querySelector("input");this.rootElement=c,this._elInput=f,this._elThumb=c.querySelector(".gsui-thumb"),this._elLine=c.querySelector(".gsui-line"),this._elLineColor=c.querySelector(".gsui-lineColor"),this._elSvg=c.querySelector("svg"),this._elSvgBg=c.querySelector(".gsui-svgBg"),this._elSvgThumb=c.querySelector(".gsui-svgThumb"),this._elSvgLine=c.querySelector(".gsui-svgLine"),this._elSvgLineColor=c.querySelector(".gsui-svgLineColor"),c.onwheel=this._wheel.bind(this),c.onmousedown=this._mousedown.bind(this),this.options({min:0,max:100,step:1,value:50,startFrom:0}),this.linear("x")}gsuiSlider.prototype={linear:function(c){this._circ=!1,this._axeX="x"===c,this.rootElement.classList.remove("gsui-circular","gsui-x","gsui-y"),this.rootElement.classList.add("gsui-linear","gsui-"+c),this._updateVal()},circular:function(){this._circ=!0,this.rootElement.classList.remove("gsui-linear","gsui-x","gsui-y"),this.rootElement.classList.add("gsui-circular"),this._updateVal()},setValue:function(c,f){var j=this._elInput,m=j.value;j.value=c,j.value!==m&&(this._updateVal(),f&&this.oninput&&this.oninput(j.value))},options:function(c){var f,j=this._elInput;for(f in c)this[f]=c[f],"startFrom"!==f&&(j[f]=c[f]);this.startFrom=_Mathmax(j.min,_Mathmin(this.startFrom,j.max)),this._updateVal()},resize:function(c,f){this.rootElement.style.width=c+"px",this.rootElement.style.height=f+"px",this._updateSize(c,f)},resized:function(){var c=this.rootElement.getBoundingClientRect();this._updateSize(c.width,c.height)},_clone:function(){var c=document.createElement("div");return gsuiSlider.template=gsuiSlider.template||this._init(),c.appendChild(document.importNode(gsuiSlider.template.content,!0)),c.removeChild(c.querySelector("*"))},_init:function(){return document.body.addEventListener("mousemove",function(c){gsuiSlider._sliderClicked&&gsuiSlider._sliderClicked._mousemove(c)}),document.body.addEventListener("mouseup",function(c){gsuiSlider._sliderClicked&&gsuiSlider._sliderClicked._mouseup(c)}),document.getElementById("gsuiSlider")},_updateVal:function(){var c,f,j=this._elInput,m=+j.value,o=j.max-j.min,q=(m-j.min)/o,t=(this.startFrom-j.min)/o,u=_Mathabs(q-t),v=_Mathmin(q,t);this.value=m,this._circ?(f=this._elSvgLineColor.style,f.strokeDasharray=u*this._svgLineLen+", 999999",f.transform="rotate("+(90+360*v)+"deg)"):(c=this._elThumb.style,f=this._elLineColor.style,this._axeX?(c.left=100*q+"%",f.left=100*v+"%",f.width=100*u+"%"):(c.bottom=100*q+"%",f.bottom=100*v+"%",f.height=100*u+"%"))},_updateSize:function(c,f){if(c!==this.width||f!==this.height){var j,m=this._elThumb.style,o=this._elLine.style,q=this._axeX?f:c,t=q/2,u=_Mathceil(q/10),v=_Mathmin(c,f);u%2!=q%2&&++u,j=q-~~t-~~t%2,m.marginLeft=m.marginBottom=j/-2+"px",m.width=m.height=j+"px",this._axeX?(o.height=u+"px",o.marginTop=u/-2+"px",o.left=o.right=t+"px"):(o.width=u+"px",o.marginLeft=u/-2+"px",o.top=o.bottom=t+"px"),this.width=c,this.height=f,this._svgLineLen=v/3,this._elSvg.setAttribute("viewBox","0 0 "+v+" "+v),this._elSvgBg.setAttribute("r",v/2),this._elSvgThumb.setAttribute("r",v/3.2),this._elSvgLine.setAttribute("r",this._svgLineLen),this._elSvgLineColor.setAttribute("r",this._svgLineLen),this._elSvgLine.style.strokeWidth=this._elSvgLineColor.style.strokeWidth=v/10,this._svgLineLen*=2*_MathPI}},_wheel:function(c){var f=0<c.deltaY?-1:1,j=this._elInput;this.setValue(+j.value+j.step*(this.axeX?-f:f),!0)},_mousedown:function(){var f=this._elInput,j=this._elLine.getBoundingClientRect(),m=this._circ?this._svgLineLen:this._axeX?j.width:j.height;this._prval=f.value,this._pxval=(f.max-f.min)/m,this._pxmoved=0,gsuiSlider._sliderClicked=this,this.rootElement.requestPointerLock()},_mouseup:function(){document.exitPointerLock(),delete gsuiSlider._sliderClicked,this._prval!==this._elInput.value&&this.onchange&&this.onchange(this._elInput.value)},_mousemove:function(c){var f=this._circ||!this._axeX?-c.movementY:c.movementX,j=this._elInput,m=(j.max-j.min)/5,o=+this._prval+(this._pxmoved+f)*this._pxval;j.min-m<o&&o<+j.max+m&&(this._pxmoved+=f),this.setValue(o,!0)}};function gsuiSpanEditable(){this.rootElement=this._clone(),this.span=this.rootElement.querySelector("span"),this.input=this.rootElement.querySelector("input"),this.rootElement.ondblclick=this._dblclick.bind(this),this.input.onblur=this._blur.bind(this),this.input.onkeydown=this._keydown.bind(this),this.setPlaceholder(""),this.setValue("")}gsuiSpanEditable.prototype={setValue:function(c,f){c=c.trim(),c!==this.value&&(this.value=c,this.rootElement.classList.toggle("gsui-empty",!c),this.span.textContent=c||this.placeholder,f&&this.onchange&&this.onchange(c))},setPlaceholder:function(c){this.placeholder=c.trim(),this.value||(this.span.textContent=this.placeholder)},_clone:function(){var c=document.createElement("div"),f=gsuiSpanEditable.template;return gsuiSpanEditable.template=f=f||document.getElementById("gsuiSpanEditable"),c.appendChild(document.importNode(f.content,!0)),c.removeChild(c.querySelector("*"))},_dblclick:function(){this.input.value=this.value,this.rootElement.classList.add("gsui-editing"),this.input.focus(),this.input.select()},_blur:function(c){this._esc||(this.setValue(c.target.value,!0),this.rootElement.classList.remove("gsui-editing")),this._esc=!1},_keydown:function(c){c.stopPropagation(),(13===c.keyCode||27===c.keyCode)&&(this._esc=27===c.keyCode,!this._esc&&this.setValue(c.target.value,!0),this.rootElement.classList.remove("gsui-editing"))}};function gsuiSpectrum(c){this.rootElement=c||document.createElement("canvas"),this.rootElement.classList.add("gsuiSpectrum"),this.ctx=this.rootElement.getContext("2d"),this.colors=[[5,2,20],[8,5,30],[15,7,50],[75,7,35],[80,0,0],[180,0,0],[200,25,10],[200,128,10],[200,200,20]]}gsuiSpectrum.prototype={setResolution:function(c){this.rootElement.width=c,this.rootElement.height=1},clear:function(){this.ctx.clearRect(0,0,this.rootElement.width,this.rootElement.height)},draw:function(c){var f,j,m,o,q,t,u,v=0,z=0,A=this.rootElement,B=this.ctx,C=A.width,D=A.height,E=c.length;for((this._datalen!==E||this._width!==C)&&this._calcWidths(c,this._datalen=E,this._width=C),u=this._widths;z<E;++z)f=1-_Mathcos(c[z]/255*_MathPI/2),.05>f?(o=4+10*f,q=4+10*f,t=5+20*f):(.08>f?(m=0,f/=.08):.15>f?(m=1,f/=.15):.17>f?(m=2,f/=.17):.25>f?(m=3,f/=.25):.3>f?(m=4,f/=.3):.4>f?(m=5,f/=.4):.6>f?(m=6,f/=.6):.8>f?(m=7,f/=.8):m=8,j=this.colors[m],o=j[0]*f,q=j[1]*f,t=j[2]*f),B.fillStyle="rgb("+~~o+","+~~q+","+~~t+")",B.fillRect(v,0,u[z],D),v+=u[z]},_calcWidths:function(c,f,j){var m,o=0,q=Array(f);for(m=0;m<f;++m)o+=q[m]=Math.log(f/(m+1));for(m=0;m<f;++m)q[m]=q[m]/o*j;this._widths=q}};function gsuiTimeLine(){var c=this._clone(),f=c.querySelector(".gsui-currentTime"),j=c.querySelector(".gsui-loopBg");this.rootElement=c,this._elTime=c.querySelector(".gsui-cursor"),this._elTimeLine=c.querySelector(".gsui-cursorLine"),this._elLoop=c.querySelector(".gsui-loop"),this._elLoopBgCL=j.classList,this._elLoopBrdACL=c.querySelector(".gsui-loopBrdA").classList,this._elLoopBrdBCL=c.querySelector(".gsui-loopBrdB").classList,this._offset=0,this._pxPerBeat=32,this._beatsPerMeasure=this._stepsPerBeat=4,this._steps=[],this.stepRound=1,this.currentTime(0),this.loop(0,0),f.onmousedown=this._mousedownTime.bind(this),f.onmousemove=this._mousemoveTime.bind(this),j.onmousedown=this._mousedownLoop.bind(this,"ab"),c.querySelector(".gsui-loopA").onmousedown=this._mousedownLoop.bind(this,"a"),c.querySelector(".gsui-loopB").onmousedown=this._mousedownLoop.bind(this,"b"),c.querySelector(".gsui-loopLine").onmousedown=this._mousedownLoopLine.bind(this)}gsuiTimeLine.prototype={resized:function(){var c=this.rootElement.getBoundingClientRect();this.width=c.width,this.height=c.height},currentTime:function(c,f){this._currentTime=c,this._updateTime(f),f&&this.onchangeCurrentTime&&this.onchangeCurrentTime(c)},offset:function(c,f){this._offset=_Mathmax(0,+c||0),this._pxPerBeat=+f,this._render()},timeSignature:function(c,f){this._beatsPerMeasure=_Mathmax(1,~~c),this._stepsPerBeat=_Mathmin(_Mathmax(1,~~f),16),this._render()},loop:function(c,f,j){var m,o,q,t=this._loop;!1===c?this._loop=c:(this._loopA=_Mathmax(0,_Mathmin(c,f)),this._loopB=_Mathmax(0,c,f)),o=this._round(this._loopA),q=this._round(this._loopB),this._loop=q-o>1/this._stepsPerBeat/8,j?this.oninputLoop&&(t&&this._loop&&(m=this._serialAB(o,q)),(t!==this._loop||this._loopSerialInp!==m)&&(this._loopSerialInp=m,this.oninputLoop(this._loop,o,q))):(this._loopWas=this._loop,this._loopSerial=this._serialAB(this._loopAWas=o,this._loopBWas=q)),this._updateLoop()},_clone:function(){var c=document.createElement("div");return gsuiTimeLine.template=gsuiTimeLine.template||this._init(),c.appendChild(document.importNode(gsuiTimeLine.template.content,!0)),c.removeChild(c.querySelector("*"))},_init:function(){return document.body.addEventListener("mousemove",function(c){gsuiTimeLine._focused&&gsuiTimeLine._focused._mousemove(c)}),document.body.addEventListener("mouseup",function(c){gsuiTimeLine._focused&&gsuiTimeLine._focused._mouseup(c)}),document.getElementById("gsuiTimeLine")},_round:function(c){if(this.stepRound){var f=1/this._stepsPerBeat*this.stepRound;c=Math.round(c/f)*f}return c},_serialAB:function(c,f){return c.toFixed(4)+" "+f.toFixed(4)},_mousemove:function(c){if(this._lock){var f=this._lockA,j=this._lockB,m=this._loopA,o=this._loopB,q=c.movementX/this._pxPerBeat;f||j?(f?m+=q:o+=q,m>o&&(this._lockA=j,this._lockB=f,this._elLoopBrdACL.toggle("gsui-hover",j),this._elLoopBrdBCL.toggle("gsui-hover",f))):(0>m+q&&(q=-m),m+=q,o+=q),this.loop(m,o,!0)}},_mouseup:function(){var f,j=this._loop,m=this._round(this._loopA),o=this._round(this._loopB);this._loopA=m,this._loopB=o,this._lock=this._lockA=this._lockB=!1,this._elLoopBgCL.remove("gsui-hover"),this._elLoopBrdACL.remove("gsui-hover"),this._elLoopBrdBCL.remove("gsui-hover"),delete gsuiTimeLine._focused,this.onchangeLoop&&(j?(f=this._serialAB(m,o),(this._loopWas!==this._loop||this._loopSerial!==f)&&(this._loopSerial=f,this.onchangeLoop(this._loopWas=j,this._loopAWas=m,this._loopBWas=o))):this._loopWas&&this.onchangeLoop(this._loopWas=j,this._loopAWas,this._loopBWas))},_mousedownTime:function(c){this.currentTime(this._round(this._offset+c.layerX/this._pxPerBeat),!0)},_mousemoveTime:function(c){var f=100*(c.layerX/this.width);this._elTimeLine.style.backgroundImage="linear-gradient(90deg,transparent "+(f-15)+"%,currentColor "+f+"%,transparent "+(f+15)+"%)"},_mousedownLoop:function(c){this._lock=!0,this._lockA="a"===c,this._lockB="b"===c,this._elLoopBgCL.toggle("gsui-hover","ab"===c),this._elLoopBrdACL.toggle("gsui-hover",this._lockA),this._elLoopBrdBCL.toggle("gsui-hover",this._lockB),gsuiTimeLine._focused=this},_mousedownLoopLine:function(c){var f=Date.now(),j=this._offset+c.layerX/this._pxPerBeat;!this._loopClick||500<f-this._loopClick?this._loopClick=f:(this.loop(!1,0,!0),this.loop(j,j,!0),this._mousedownLoop("b"))},_updateTime:function(c){this._elTime.classList.toggle("gsui-trans",!!c),this._elTime.style.left=(this._currentTime-this._offset)*this._pxPerBeat+"px"},_updateLoop:function(){var c=this._elLoop.style;if(this._loop){var f=this._pxPerBeat,j=this._offset,m=this._round(this._loopA),o=this._round(this._loopB);c.left=(m-j)*f+"px",c.right=this.width-(o-j)*f+"px"}c.display=this._loop?"block":"none"},_render:function(){var c,f,j=this.rootElement.classList,m=this._steps,o=this._pxPerBeat,q=this._stepsPerBeat,t=q*this._beatsPerMeasure,v=1/q,z=0,A=_Mathceil(this.width/(o/q)+2),B=this.width/o,C=~~(this._offset*q),D=-this._offset%v;for(j.remove("gsui-step","gsui-beat","gsui-measure"),j.add("gsui-"+(24<o?72<o?"step":"beat":"measure"));m.length<A;)f=document.createElement("div"),m.push(f);for(;z<A;++z)c=C%q,f=m[z],f.style.left=D*o+"px",f.className="gsui-"+(C%t?c?"step":"beat":"measure"),f.textContent="gsui-step"===f.className?".":~~(1+C/q),f.parentNode||this.rootElement.append(f),++C,D+=v;for(;z<m.length&&(f=m[z],!!f.parentNode);++z)f.remove();this._updateTime(),this._updateLoop()}};function gsuiToggle(){var c=this._clone(),f=c.querySelector("input");this.rootElement=c,this._circCL=c.querySelector(".gsui-circle").classList,this.checked=!1,c.oncontextmenu=function(){return!1},c.onmousedown=this._mousedown.bind(this)}gsuiToggle.prototype={check:function(){this._set(!0)},uncheck:function(){this._set(!1)},toggle:function(c){this._set(arguments.length?!!c:!this.checked)},_clone:function(){var c=document.createElement("div");return gsuiToggle.template=gsuiToggle.template||document.getElementById("gsuiToggle"),c.appendChild(document.importNode(gsuiToggle.template.content,!0)),c.removeChild(c.querySelector("*"))},_set:function(c,f){c!==this.checked&&(this.checked=c,this._circCL.toggle("gsui-on",c),f&&this.onchange&&this.onchange(c))},_mousedown:function(c){0===c.button?this._set(!this.checked,!0):2===c.button&&this.onmousedownright&&this.onmousedownright()}};function gsuiWave(c){var f="http://www.w3.org/2000/svg";this.rootElement=c||document.createElementNS(f,"svg"),this.rootElement.setAttribute("preserveAspectRatio","none"),this.rootElement.classList.add("gsuiWave"),this.polyline=this.rootElement.querySelector("polyline"),this.polyline||(this.polyline=document.createElementNS(f,"polyline"),this.rootElement.appendChild(this.polyline)),this.type="sine",this.frequency=1,this.attack=this.amplitude=0}gsuiWave.sine=function(c){return _Mathsin(c)},gsuiWave.square=function(c){return 0<_Mathsin(c)?1:-1},gsuiWave.sawtooth=function(c){return c/=2*_MathPI,2*(c-Math.floor(c+.5))},gsuiWave.triangle=function(c){return 2*_Mathabs(gsuiWave.sawtooth(c+_MathPI/2))-1},gsuiWave.prototype={setResolution:function(c,f){this.width=c,this.height=f,this.rootElement.setAttribute("viewBox","0 0 "+c+" "+f)},draw:function(){for(var c=0,f=this.width,j=this.height/2,m=-this.amplitude*j,o=f*this.attack,q=2*_MathPI/f*this.frequency,t=gsuiWave[this.type],u=new Float32Array(2*f);c<f;++c)u[2*c]=c,u[2*c+1]=j+t(c*q)*m*(c<o?c/o:1);this.polyline.setAttribute("points",u.join(" "))}};function gsuiWaveform(c){var f="http://www.w3.org/2000/svg";this.rootElement=c||document.createElementNS(f,"svg"),this.rootElement.setAttribute("preserveAspectRatio","none"),this.rootElement.classList.add("gsuiWaveform"),this.polygon=this.rootElement.querySelector("polygon"),this.polygon||(this.polygon=document.createElementNS(f,"polygon"),this.rootElement.appendChild(this.polygon))}gsuiWaveform.prototype={setResolution:function(c,f){this.width=c,this.height=f,this.rootElement.setAttribute("viewBox","0 0 "+c+" "+f)},clear:function(){this.polygon.removeAttribute("points")},drawBuffer:function(c,f,j){var m=c.getChannelData(0),o=1<c.numberOfChannels?c.getChannelData(1):m;f=f||0,this.draw(m,o,c.duration,f,j||c.duration-f)},draw:function(c,f,j,m,o){var q,t=this.width,u=this.height,v=u/2,z=c.length,A=~~(m/j*z),B=o/j*z/t,C="0,"+(v+c[A]*v),D="0,"+(v+f[A]*v),E=~~_Mathmax(1,B/100);for(q=1;q<t;++q){for(var F=Infinity,G=-Infinity,H=~~(A+(q-1)*B),I=H+B;H<I;H+=E)F=_Mathmin(F,c[H],f[H]),G=_Mathmax(G,c[H],f[H]);1>_Mathabs(G-F)*v&&(G+=1/u,F-=1/u),C+=" "+q+","+(v+F*v),D=q+","+(v+G*v)+" "+D}this.polygon.setAttribute("points",C+" "+D)}};
